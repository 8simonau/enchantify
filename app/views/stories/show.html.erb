<div class="story-status" data-controller="story-status" data-story-status-storyid-value="<%= @story.id %>">

  <div class="story-preparation" data-story-status-target="preparation">
      <i class="fas fa-spinner fa-spin"></i>
      <h1>Invention en cours...</h1>
  </div>

  <div data-story-status-target="available" hidden>
    <%# here stimulus inserts the _display_story partial when it is available %>
  </div>

  <div class="story-end" data-story-status-target="ended" hidden>
    <h1 class="mb-3">Fin...</h1>
    <div class="picture-with-repeat-wrapper">
      <% if @story.pictures.attached? %>
        <%= cl_image_tag(@story.pictures.first.key,
          secure: true,
          width: 290,
          height: 290,
          class: "story-picture",
          opacity: 60) %>
        <% end %>
      <button
        class="centered-repeat-button media-button",
        data-action="click->story-status#displayAvailableScreen">
        <i class="fa-solid fa-repeat"></i>
      </button>
    </div>
    <span class="mt-3 text-center"><strong><%= @story.title %></strong></span>
    <p>Créée le <%= @story.created_at.strftime("%d/%m/%y") %></p>

    <h3 class="mt-5">Histoires récentes</h3>
    <div class="story-end-horizontal-list">
      <% @recent_stories.each do |story| %>
        <div class="small-story-card">
          <div class="small-story-card-bottom">
            <% if story.pictures.attached? %>
              <%= cl_image_tag(story.pictures.first.key,
                secure: true,
                width: 60,
                height: 60,
                class: "option-picture") %>
            <% end %>
          <div>
            <%= link_to story_path(story) do %>
              <div class="play-button-mini">
                <i class="fa-solid fa-circle-play"></i>
              </div>
            <% end %>
          </div>
          </div>
          <span><%= story.title %></span>
        </div>
      <% end %>
    </div>

    <div class="bottom-buttons-wrapper">
      <%= link_to "Créer une histoire", new_story_path, class: "btn btn-standard btn-large" %>
    </div>

  </div>

</div>
